@import 'colors.scss';

@font-face {
  font-family: 'Bentham Regular';
  font-style: normal;
  font-weight: normal;
  src: url('assets/Bentham-Regular.ttf') format('truetype');
}

@font-face {
  font-family: 'Carnevalee Freakshow';
  font-style: normal;
  font-weight: normal;
  src: url('assets/Carnevalee Freakshow.ttf') format('truetype');
}

@font-face {
  font-family: 'Quicksand Light';
  font-style: normal;
  font-weight: 100;
  src: url('assets/quicksand.light-regular.otf') format('opentype');
}

:root {
  // NOTE: this is set in root.ts
  --map-side-matter-cx: 0;
  // NOTE: these set in geometry.ts
  --map-clip-x: 0;
  --map-clip-y: 0;
  --map-clip-cx: 0;
  --map-clip-cy: 0;
  --map-cxNominal: 0;
  --map-cyNominal: 0;
  --map-cxTile: 0;
  --map-cyTile: 0;
  --map-numHGrids: 0;
  --map-numVGrids: 0;
  --map-numXTiles: 0;
  --map-numYTiles: 0;
  --map-scale: 1;
  // land use color shading
  --shade-u11: var(--mat-brown-100);
  --shade-u12: var(--mat-brown-200);
  --shade-u17: var(--mat-red-100);
  --shade-u19: var(--mat-light-green-100);
  --shade-u22: var(--mat-orange-100);
  --shade-u26: var(--mat-purple-100);
  --shade-u33: var(--mat-indigo-100);
  --shade-u58: var(--mat-blue-100);
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

:focus {
  outline: 0;
}

body {
  background-color: white;
  display: grid;
  height: 100%;
  place-content: center;
  user-select: none;
  width: 100%;
}

html {
  border: 0;
  font-size: 14px;
  height: 100%;
  width: 100%;
}

map-root {
  background-color: white;
  display: grid;
  grid-template-areas:
    'map side-matter'
    'map side-matter';
  overflow: hidden;

  &.dragging {
    cursor: grabbing;
  }

  &.printing {
    cursor: wait;
    overflow: unset;
  }

  aside {
    grid-area: side-matter;
    padding: calc(var(--map-cyNominal) * var(--map-scale) / 100)
      calc(var(--map-cxNominal) * var(--map-scale) / 100);
    width: var(--map-side-matter-cx);

    map-legend {
      display: block;
      height: 100%;
      width: 100%;

      header {
        font-family: 'Carnevalee Freakshow', sans-serif;
        text-align: center;

        h1 {
          font-size: 4rem;
          font-weight: normal;
        }

        h2 {
          font-size: 2rem;
          font-weight: normal;
        }
      }
    }
  }

  main {
    grid-area: map;

    .border-1 {
      border: 3px solid var(--mat-gray-600);
      margin: calc(var(--map-cyNominal) * var(--map-scale) / 100)
        calc(var(--map-cxNominal) * var(--map-scale) / 100);
    }

    .border-2 {
      background-color: var(--mat-brown-50);
      border: calc(var(--map-cyNominal) * var(--map-scale) / 300) dashed
        var(--mat-gray-600);
    }

    .border-3 {
      background-color: white;
      border: 1px solid var(--mat-gray-600);
      padding: calc(var(--map-cyNominal) * var(--map-scale) / 200)
        calc(var(--map-cxNominal) * var(--map-scale) / 200);
    }

    section {
      display: block;
      height: calc(var(--map-clip-cy) * var(--map-scale));
      overflow: hidden;
      position: relative;
      width: calc(var(--map-clip-cx) * var(--map-scale));

      figure {
        cursor: normal;
        display: block;
        height: calc(var(--map-cyNominal) * var(--map-scale));
        position: absolute;
        transform: translate(
          calc(var(--map-clip-x) * var(--map-scale) * -1),
          calc(var(--map-clip-y) * var(--map-scale) * -1)
        );
        width: calc(var(--map-cxNominal) * var(--map-scale));

        map-boundary,
        map-clip,
        map-grid,
        map-indices,
        map-lots,
        map-street,
        map-tiles,
        map-topo {
          display: block;
          height: 100%;
          position: absolute;
          width: 100%;
        }

        map-boundary,
        map-clip,
        map-grid,
        map-indices,
        map-lots {
          svg {
            height: 100%;
            width: 100%;

            & > g {
              transform: scale(var(--map-scale), var(--map-scale));
            }
          }
        }

        map-boundary {
          g polygon {
            fill: none;
            stroke: var(--mat-gray-800);
            stroke-dasharray: 4;
            stroke-width: 3;
          }
        }

        map-grid {
          g path {
            fill: none;
            stroke: var(--mat-gray-800);
            stroke-width: 0.25;
          }
        }

        map-indices {
          g polygon {
            fill: none;
            stroke: var(--mat-gray-500);
            stroke-opacity: 0.5;
            stroke-width: 8;
          }
        }

        map-lots {
          clip-path: url(#boundary);

          g path.black {
            fill: none;
            stroke: var(--mat-blue-gray-300);
            stroke-width: 1;
          }

          g path.white {
            fill: none;
            mix-blend-mode: multiply;
            stroke: var(--mat-blue-gray-50);
            stroke-dasharray: 1, 2;
            stroke-width: 1;
          }

          // @see https://www.gismanual.com/style/ColorConventions.pdf

          g path.white.u11 /* Single family */ {
            fill: var(--shade-u11);
          }

          g path.white.u12 /* Multi family */ {
            fill: var(--shade-u12);
          }

          g path.white.u17 /* Manufacturing */ {
            fill: var(--shade-u17);
          }

          g path.white.u19 /* Unclassified improved residential */ {
            fill: var(--shade-u19);
          }

          g path.white.u22 /* Residential land */ {
            fill: var(--shade-u22);
          }

          g path.white.u26 /* Mixed use */ {
            fill: var(--shade-u26);
          }

          g path.white.u33 /* Commercial */ {
            fill: var(--shade-u33);
          }

          g path.white.u58 /* Garage */ {
            fill: var(--shade-u58);
          }

          g text {
            color: var(--mat-gray-500);
            font-family: sans-serif;
            font-size: 10px;
          }
        }

        map-tile {
          display: inline-block;
          height: calc(var(--map-cyTile) * var(--map-scale));
          position: relative;
          vertical-align: top;
          width: calc(var(--map-cxTile) * var(--map-scale));

          canvas {
            height: var(--map-cyTile);
            position: absolute;
            visibility: hidden;
            width: var(--map-cxTile);
          }

          img {
            height: 100%;
            position: absolute;
            width: 100%;
          }

          img.inside {
            filter: none;
          }

          img.outside {
            filter: grayscale(1);
          }
        }
      }

      figcaption {
        align-items: flex-end;
        color: var(--mat-gray-700);
        display: flex;
        font-family: 'Bentham Regular', sans-serif;
        font-size: 1rem;
        height: 100%;
        justify-content: space-between;
        padding: 0.25rem;
        position: absolute;
        width: 100%;
      }
    }
  }
}
